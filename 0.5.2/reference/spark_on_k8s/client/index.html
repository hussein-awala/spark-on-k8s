
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Spark On Kubernetes documentation">
      
      
        <meta name="author" content="hussein-awala">
      
      
        <link rel="canonical" href="https://hussein.awala.fr/spark-on-k8s/0.5.2/reference/spark_on_k8s/client/">
      
      
        <link rel="prev" href="../cli/options/">
      
      
        <link rel="next" href="../k8s/async_client/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>client - Spark On K8s</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spark_on_k8s.client" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Spark On K8s" class="md-header__button md-logo" aria-label="Spark On K8s" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spark On K8s
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              client
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/hussein-awala/spark-on-k8s" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    hussein-awala/spark-on-k8s
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Spark On Kubernetes

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../user-guide/installation/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../airflow/operator_links/" class="md-tabs__link">
          
  
  
    
  
  Code Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../helm-chart/" class="md-tabs__link">
          
  
  
    
  
  Helm Chart

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Spark On K8s" class="md-nav__button md-logo" aria-label="Spark On K8s" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Spark On K8s
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hussein-awala/spark-on-k8s" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    hussein-awala/spark-on-k8s
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spark On Kubernetes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    airflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            airflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../airflow/operator_links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    operator_links
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../airflow/operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../airflow/provider_info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    provider_info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    scripts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../airflow/scripts/spark_sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    spark_sql
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../airflow/triggers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    triggers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    app
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/apps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    apps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    auth
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            auth
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/auth/auth_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    auth_manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/auth/base_auth_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base_auth_manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/auth/base_user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base_user
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/auth/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    main
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2_7" >
        
          
          <label class="md-nav__link" for="__nav_3_2_7" id="__nav_3_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    webserver
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_7">
            <span class="md-nav__icon md-icon"></span>
            webserver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/webserver/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    security
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    app
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/apps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    apps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/namespace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    namespace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/options/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    options
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    client
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    client
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client" class="md-nav__link">
    <span class="md-ellipsis">
      client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.ExecutorInstances" class="md-nav__link">
    <span class="md-ellipsis">
      ExecutorInstances
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.PodResources" class="md-nav__link">
    <span class="md-ellipsis">
      PodResources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.SparkAppWait" class="md-nav__link">
    <span class="md-ellipsis">
      SparkAppWait
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.SparkOnK8S" class="md-nav__link">
    <span class="md-ellipsis">
      SparkOnK8S
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparkOnK8S">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark_on_k8s.client.SparkOnK8S.submit_app" class="md-nav__link">
    <span class="md-ellipsis">
      submit_app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.default_app_id_suffix" class="md-nav__link">
    <span class="md-ellipsis">
      default_app_id_suffix
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    k8s
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            k8s
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k8s/async_client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    async_client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k8s/sync_client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sync_client
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/app_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    app_manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/async_app_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    async_app_manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/logging_mixin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    logging_mixin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/setup_namespace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    setup_namespace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/spark_app_status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    spark_app_status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/warnings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    warnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../helm-chart/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Helm Chart
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Helm Chart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Config
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/autoscaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    autoscaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/ingress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ingress
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Root
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/serviceAccount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    serviceAccount
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../helm-chart/config/sparkHistory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sparkHistory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client" class="md-nav__link">
    <span class="md-ellipsis">
      client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.ExecutorInstances" class="md-nav__link">
    <span class="md-ellipsis">
      ExecutorInstances
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.PodResources" class="md-nav__link">
    <span class="md-ellipsis">
      PodResources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.SparkAppWait" class="md-nav__link">
    <span class="md-ellipsis">
      SparkAppWait
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.SparkOnK8S" class="md-nav__link">
    <span class="md-ellipsis">
      SparkOnK8S
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SparkOnK8S">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark_on_k8s.client.SparkOnK8S.submit_app" class="md-nav__link">
    <span class="md-ellipsis">
      submit_app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark_on_k8s.client.default_app_id_suffix" class="md-nav__link">
    <span class="md-ellipsis">
      default_app_id_suffix
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>client</h1>

<div class="doc doc-object doc-module">



<a id="spark_on_k8s.client"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="spark_on_k8s.client.ExecutorInstances" class="doc doc-heading">
            <code>ExecutorInstances</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Number of executors to request</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.ExecutorInstances.min">min</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum number of executors. If provided, dynamic allocation is enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.ExecutorInstances.max">max</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of executors. If provided, dynamic allocation is enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.ExecutorInstances.initial">initial</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial number of executors. If max and min are not provided, defaults to 2,
dynamic allocation will be disabled and the number of executors will be fixed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.ExecutorInstances.executor_allocation_ratio">executor_allocation_ratio</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Executor allocation ratio to use for dynamic allocation.
Defaults to 1.0</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.ExecutorInstances.scheduler_backlog_timeout">scheduler_backlog_timeout</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scheduler backlog timeout to use for dynamic allocation.
Defaults to "1s"</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.ExecutorInstances.sustained_scheduler_backlog_timeout">sustained_scheduler_backlog_timeout</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sustained scheduler backlog timeout to use for
dynamic allocation. Defaults to sustained_scheduler_backlog_timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>spark_on_k8s/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="o">**</span><span class="n">KW_ONLY_DATACLASS</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExecutorInstances</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of executors to request</span>

<span class="sd">    Attributes:</span>
<span class="sd">        min: Minimum number of executors. If provided, dynamic allocation is enabled</span>
<span class="sd">        max: Maximum number of executors. If provided, dynamic allocation is enabled</span>
<span class="sd">        initial: Initial number of executors. If max and min are not provided, defaults to 2,</span>
<span class="sd">            dynamic allocation will be disabled and the number of executors will be fixed.</span>
<span class="sd">        executor_allocation_ratio: Executor allocation ratio to use for dynamic allocation.</span>
<span class="sd">            Defaults to 1.0</span>
<span class="sd">        scheduler_backlog_timeout: Scheduler backlog timeout to use for dynamic allocation.</span>
<span class="sd">            Defaults to &quot;1s&quot;</span>
<span class="sd">        sustained_scheduler_backlog_timeout: Sustained scheduler backlog timeout to use for</span>
<span class="sd">            dynamic allocation. Defaults to sustained_scheduler_backlog_timeout.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">initial</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">executor_allocation_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">scheduler_backlog_timeout</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1s&quot;</span>
    <span class="n">sustained_scheduler_backlog_timeout</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="spark_on_k8s.client.PodResources" class="doc doc-heading">
            <code>PodResources</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Resources to request for the Spark driver and executors</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.PodResources.cpu">cpu</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of CPU cores to request</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.PodResources.memory">memory</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Amount of memory to request in MB</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spark_on_k8s.client.PodResources.memory_overhead">memory_overhead</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Amount of memory overhead to request in MB</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>spark_on_k8s/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="o">**</span><span class="n">KW_ONLY_DATACLASS</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PodResources</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resources to request for the Spark driver and executors</span>

<span class="sd">    Attributes:</span>
<span class="sd">        cpu: Number of CPU cores to request</span>
<span class="sd">        memory: Amount of memory to request in MB</span>
<span class="sd">        memory_overhead: Amount of memory overhead to request in MB</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cpu</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">memory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">memory_overhead</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="spark_on_k8s.client.SparkAppWait" class="doc doc-heading">
            <code>SparkAppWait</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enum for the Spark app waiter options</p>







              <details class="quote">
                <summary>Source code in <code>spark_on_k8s/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SparkAppWait</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enum for the Spark app waiter options&quot;&quot;&quot;</span>

    <span class="n">NO_WAIT</span> <span class="o">=</span> <span class="s2">&quot;no_wait&quot;</span>
    <span class="n">WAIT</span> <span class="o">=</span> <span class="s2">&quot;wait&quot;</span>
    <span class="n">LOG</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="spark_on_k8s.client.SparkOnK8S" class="doc doc-heading">
            <code>SparkOnK8S</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="spark_on_k8s.utils.logging_mixin.LoggingMixin">LoggingMixin</span></code></p>


        <p>Client for submitting Spark apps to Kubernetes</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spark_on_k8s.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkOnK8S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spark</span> <span class="o">=</span> <span class="n">SparkOnK8S</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spark</span><span class="o">.</span><span class="n">submit_app</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="s2">&quot;husseinawala/spark:v3.5.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">app_path</span><span class="o">=</span><span class="s2">&quot;local:///opt/spark/examples/jars/spark-examples_2.12-3.5.0.jar&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">class_name</span><span class="o">=</span><span class="s2">&quot;org.apache.spark.examples.SparkPi&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">app_name</span><span class="o">=</span><span class="s2">&quot;spark-pi&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">app_arguments</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1000&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">namespace</span><span class="o">=</span><span class="s2">&quot;spark&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">service_account</span><span class="o">=</span><span class="s2">&quot;spark&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">app_waiter</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>k8s_client_manager</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;KubernetesClientManager&lt;/code&gt; (&lt;code&gt;spark_on_k8s.k8s.sync_client.KubernetesClientManager&lt;/code&gt;)" href="../k8s/sync_client/#spark_on_k8s.k8s.sync_client.KubernetesClientManager">KubernetesClientManager</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes client manager to use for creating Kubernetes clients</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the logger to use for logging, defaults to "SparkOnK8S"</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>spark_on_k8s/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SparkOnK8S</span><span class="p">(</span><span class="n">LoggingMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Client for submitting Spark apps to Kubernetes</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spark_on_k8s.client import SparkOnK8S</span>
<span class="sd">        &gt;&gt;&gt; spark = SparkOnK8S()</span>
<span class="sd">        &gt;&gt;&gt; spark.submit_app(</span>
<span class="sd">        ...     image=&quot;husseinawala/spark:v3.5.0&quot;,</span>
<span class="sd">        ...     app_path=&quot;local:///opt/spark/examples/jars/spark-examples_2.12-3.5.0.jar&quot;,</span>
<span class="sd">        ...     class_name=&quot;org.apache.spark.examples.SparkPi&quot;,</span>
<span class="sd">        ...     app_name=&quot;spark-pi&quot;,</span>
<span class="sd">        ...     app_arguments=[&quot;1000&quot;],</span>
<span class="sd">        ...     namespace=&quot;spark&quot;,</span>
<span class="sd">        ...     service_account=&quot;spark&quot;,</span>
<span class="sd">        ...     app_waiter=&quot;log&quot;,</span>
<span class="sd">        ... )</span>

<span class="sd">    Args:</span>
<span class="sd">        k8s_client_manager: Kubernetes client manager to use for creating Kubernetes clients</span>
<span class="sd">        logger_name: Name of the logger to use for logging, defaults to &quot;SparkOnK8S&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">k8s_client_manager</span><span class="p">:</span> <span class="n">KubernetesClientManager</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">logger_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">logger_name</span><span class="o">=</span><span class="n">logger_name</span> <span class="ow">or</span> <span class="s2">&quot;SparkOnK8S&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k8s_client_manager</span> <span class="o">=</span> <span class="n">k8s_client_manager</span> <span class="ow">or</span> <span class="n">KubernetesClientManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span> <span class="o">=</span> <span class="n">SparkAppManager</span><span class="p">(</span><span class="n">k8s_client_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k8s_client_manager</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">submit_app</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">service_account</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">spark_conf</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">class_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">packages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">app_arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">app_id_suffix</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">app_waiter</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;no_wait&quot;</span><span class="p">,</span> <span class="s2">&quot;wait&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">image_pull_policy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Always&quot;</span><span class="p">,</span> <span class="s2">&quot;Never&quot;</span><span class="p">,</span> <span class="s2">&quot;IfNotPresent&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">ui_reverse_proxy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_resources</span><span class="p">:</span> <span class="n">PodResources</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_resources</span><span class="p">:</span> <span class="n">PodResources</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_instances</span><span class="p">:</span> <span class="n">ExecutorInstances</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">should_print</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">secret_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConfigMap</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_env_vars_from_secrets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">volumes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_volume_mounts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_volume_mounts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_node_selector</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_node_selector</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_annotations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_annotations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_tolerations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Toleration</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">executor_pod_template_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">startup_timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_init_containers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Container</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">driver_host_aliases</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1HostAlias</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Submit a Spark app to Kubernetes</span>

<span class="sd">        Args:</span>
<span class="sd">            image: Docker image to use for the Spark driver and executors</span>
<span class="sd">            app_path: Path to the application JAR / Python / R file</span>
<span class="sd">            namespace: Kubernetes namespace to use, defaults to &quot;default&quot;</span>
<span class="sd">            service_account: Kubernetes service account to use for the Spark driver,</span>
<span class="sd">                defaults to &quot;spark&quot;</span>
<span class="sd">            app_name: Name of the Spark application, defaults to a generated name as</span>
<span class="sd">                `spark-app{app_id_suffix()}`</span>
<span class="sd">            spark_conf: Dictionary of spark configuration to pass to the application</span>
<span class="sd">            class_name: Name of the class to execute</span>
<span class="sd">            packages: List of maven coordinates of jars to include in the classpath</span>
<span class="sd">            app_arguments: List of arguments to pass to the application</span>
<span class="sd">            app_id_suffix: Function to generate a suffix for the application ID, defaults to</span>
<span class="sd">                `default_app_id_suffix`</span>
<span class="sd">            app_waiter: How to wait for the app to finish. One of &quot;no_wait&quot;, &quot;wait&quot;, or &quot;log&quot;</span>
<span class="sd">            image_pull_policy: Image pull policy for the driver and executors, defaults to &quot;IfNotPresent&quot;</span>
<span class="sd">            ui_reverse_proxy: Whether to use a reverse proxy for the Spark UI, defaults to False</span>
<span class="sd">            driver_resources: Resources to request for the Spark driver. Defaults to 1 CPU core, 1Gi of</span>
<span class="sd">                memory and512Mi of memory overhead</span>
<span class="sd">            executor_resources: Resources to request for the Spark executors. Defaults to 1 CPU core, 1Gi</span>
<span class="sd">                of memory and 512Mi of memory overhead</span>
<span class="sd">            executor_instances: Number of executors to request. If max and min are not provided, dynamic</span>
<span class="sd">                allocation will be disabled and the number of executors will be fixed to initial or 2 if</span>
<span class="sd">                initial is not provided. If max or min or both are provided, dynamic allocation will be</span>
<span class="sd">                enabled and the number of executors will be between min and max (inclusive), and initial</span>
<span class="sd">                will be the initial number of executors with a default of 0.</span>
<span class="sd">            should_print: Whether to print logs instead of logging them, defaults to False</span>
<span class="sd">            secret_values: Dictionary of secret values to pass to the application as environment variables</span>
<span class="sd">            driver_ephemeral_configmaps_volumes: List of ephemeral configmaps to create for the application</span>
<span class="sd">                driver</span>
<span class="sd">            driver_env_vars_from_secrets: List of secret names to load environment variables from for</span>
<span class="sd">                the driver</span>
<span class="sd">            volumes: List of volumes to mount to the driver and/or executors</span>
<span class="sd">            driver_volume_mounts: List of volume mounts to mount to the driver</span>
<span class="sd">            executor_volume_mounts: List of volume mounts to mount to the executors</span>
<span class="sd">            driver_node_selector: Node selector for the driver</span>
<span class="sd">            executor_node_selector: Node selector for the executors</span>
<span class="sd">            driver_tolerations: List of tolerations for the driver</span>
<span class="sd">            executor_pod_template_path: Path to the executor pod template file</span>
<span class="sd">            startup_timeout: Timeout in seconds to wait for the application to start</span>
<span class="sd">            driver_init_containers: List of init containers to run before the driver starts</span>
<span class="sd">            driver_host_aliases: List of host aliases for the driver</span>

<span class="sd">        Returns:</span>
<span class="sd">            Name of the Spark application pod</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">image</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DOCKER_IMAGE</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Docker image is not set.&quot;</span>
                    <span class="s2">&quot;Please set the image argument or the environment variable SPARK_ON_K8S_DOCKER_IMAGE&quot;</span>
                <span class="p">)</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DOCKER_IMAGE</span>
        <span class="k">if</span> <span class="n">app_path</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_PATH</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Application path is not set.&quot;</span>
                    <span class="s2">&quot;Please set the app_path argument or the environment variable SPARK_ON_K8S_APP_PATH&quot;</span>
                <span class="p">)</span>
            <span class="n">app_path</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_PATH</span>
        <span class="k">if</span> <span class="n">namespace</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">namespace</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_NAMESPACE</span>
        <span class="k">if</span> <span class="n">service_account</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">service_account</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SERVICE_ACCOUNT</span>
        <span class="k">if</span> <span class="n">app_name</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_NAME</span>
        <span class="k">if</span> <span class="n">spark_conf</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">spark_conf</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SPARK_CONF</span>
        <span class="k">if</span> <span class="n">class_name</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_CLASS_NAME</span>
        <span class="k">if</span> <span class="n">packages</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">packages</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_PACKAGES</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_PACKAGES</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">app_arguments</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">app_arguments</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_ARGUMENTS</span>
        <span class="k">if</span> <span class="n">app_id_suffix</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">app_id_suffix</span> <span class="o">=</span> <span class="n">default_app_id_suffix</span>
        <span class="k">if</span> <span class="n">app_waiter</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">app_waiter</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_WAITER</span>
        <span class="k">if</span> <span class="n">image_pull_policy</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">image_pull_policy</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_IMAGE_PULL_POLICY</span>
        <span class="k">if</span> <span class="n">ui_reverse_proxy</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">ui_reverse_proxy</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_UI_REVERSE_PROXY</span>
        <span class="k">if</span> <span class="n">driver_resources</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">driver_resources</span> <span class="o">=</span> <span class="n">PodResources</span><span class="p">(</span>
                <span class="n">cpu</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_CPU</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_MEMORY</span><span class="p">,</span>
                <span class="n">memory_overhead</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_MEMORY_OVERHEAD</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">executor_resources</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">executor_resources</span> <span class="o">=</span> <span class="n">PodResources</span><span class="p">(</span>
                <span class="n">cpu</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_CPU</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MEMORY</span><span class="p">,</span>
                <span class="n">memory_overhead</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MEMORY_OVERHEAD</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">executor_instances</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">executor_instances</span> <span class="o">=</span> <span class="n">ExecutorInstances</span><span class="p">(</span>
                <span class="nb">min</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MIN_INSTANCES</span><span class="p">,</span>
                <span class="nb">max</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MAX_INSTANCES</span><span class="p">,</span>
                <span class="n">initial</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_INITIAL_INSTANCES</span><span class="p">,</span>
                <span class="n">executor_allocation_ratio</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_ALLOCATION_RATIO</span><span class="p">,</span>
                <span class="n">scheduler_backlog_timeout</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SCHEDULER_BACKLOG_TIMEOUT</span><span class="p">,</span>
                <span class="n">sustained_scheduler_backlog_timeout</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SUSTAINED_SCHEDULER_BACKLOG_TIMEOUT</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">executor_instances</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">app_name</span><span class="p">,</span> <span class="n">app_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_app_name_and_id</span><span class="p">(</span>
            <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span> <span class="n">app_id_suffix</span><span class="o">=</span><span class="n">app_id_suffix</span><span class="p">,</span> <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">secret_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTSET</span> <span class="ow">and</span> <span class="n">secret_values</span><span class="p">:</span>
            <span class="n">env_from_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">app_id</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">secret_values</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SECRET_ENV_VAR</span>
            <span class="n">env_from_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">app_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">secret_values</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">driver_ephemeral_configmaps_volumes</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">driver_ephemeral_configmaps_volumes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">driver_env_vars_from_secrets</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">driver_env_vars_from_secrets</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_ENV_VARS_FROM_SECRET</span>
        <span class="k">if</span> <span class="n">driver_env_vars_from_secrets</span><span class="p">:</span>
            <span class="n">env_from_secrets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">driver_env_vars_from_secrets</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">volumes</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">volumes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">volumes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">driver_volume_mounts</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_volume_mounts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">driver_volume_mounts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">executor_volume_mounts</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_volume_mounts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">executor_volume_mounts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">driver_node_selector</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_node_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">driver_node_selector</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">executor_node_selector</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_node_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">executor_node_selector</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">driver_annotations</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_annotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">driver_annotations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">executor_annotations</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_annotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">executor_annotations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">driver_labels</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">driver_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">executor_labels</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">executor_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">driver_tolerations</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_tolerations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">driver_tolerations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">executor_pod_template_path</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_pod_template_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">executor_pod_template_path</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_POD_TEMPLATE_PATH</span>
        <span class="k">if</span> <span class="n">startup_timeout</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">startup_timeout</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_STARTUP_TIMEOUT</span>
        <span class="k">if</span> <span class="n">driver_init_containers</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">driver_init_containers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">driver_host_aliases</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">driver_host_aliases</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">spark_conf</span> <span class="o">=</span> <span class="n">spark_conf</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">main_class_parameters</span> <span class="o">=</span> <span class="n">app_arguments</span> <span class="ow">or</span> <span class="p">[]</span>

        <span class="n">driver_resources</span> <span class="o">=</span> <span class="n">driver_resources</span> <span class="ow">or</span> <span class="n">PodResources</span><span class="p">()</span>
        <span class="n">executor_resources</span> <span class="o">=</span> <span class="n">executor_resources</span> <span class="ow">or</span> <span class="n">PodResources</span><span class="p">()</span>
        <span class="n">executor_instances</span> <span class="o">=</span> <span class="n">executor_instances</span> <span class="ow">or</span> <span class="n">ExecutorInstances</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">basic_conf</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;spark.app.name&quot;</span><span class="p">:</span> <span class="n">app_name</span><span class="p">,</span>
            <span class="s2">&quot;spark.app.id&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
            <span class="s2">&quot;spark.kubernetes.namespace&quot;</span><span class="p">:</span> <span class="n">namespace</span><span class="p">,</span>
            <span class="s2">&quot;spark.kubernetes.authenticate.driver.serviceAccountName&quot;</span><span class="p">:</span> <span class="n">service_account</span><span class="p">,</span>
            <span class="s2">&quot;spark.kubernetes.container.image&quot;</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span>
            <span class="s2">&quot;spark.driver.host&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
            <span class="s2">&quot;spark.driver.port&quot;</span><span class="p">:</span> <span class="s2">&quot;7077&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spark.kubernetes.driver.pod.name&quot;</span><span class="p">:</span> <span class="n">SparkAppManager</span><span class="o">.</span><span class="n">_get_pod_name</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">),</span>
            <span class="s2">&quot;spark.kubernetes.executor.podNamePrefix&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
            <span class="s2">&quot;spark.kubernetes.container.image.pullPolicy&quot;</span><span class="p">:</span> <span class="n">image_pull_policy</span><span class="p">,</span>
            <span class="s2">&quot;spark.driver.memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spark.executor.cores&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_resources</span><span class="o">.</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spark.executor.memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_resources</span><span class="o">.</span><span class="n">memory</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spark.executor.memoryOverhead&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_resources</span><span class="o">.</span><span class="n">memory_overhead</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_secrets_config</span><span class="p">(</span><span class="n">secret_values</span><span class="o">=</span><span class="n">secret_values</span><span class="p">,</span> <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="n">extra_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">ui_reverse_proxy</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.ui.proxyBase&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/webserver/ui/</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.ui.proxyRedirectUri&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>
            <span class="n">extra_labels</span><span class="p">[</span><span class="s2">&quot;spark-ui-proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
        <span class="k">if</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.shuffleTracking.enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.minExecutors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">min</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.maxExecutors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.initialExecutors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.executorAllocationRatio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                <span class="n">executor_instances</span><span class="o">.</span><span class="n">executor_allocation_ratio</span>
            <span class="p">)</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.schedulerBacklogTimeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">executor_instances</span><span class="o">.</span><span class="n">scheduler_backlog_timeout</span>
            <span class="p">)</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.sustainedSchedulerBacklogTimeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">executor_instances</span><span class="o">.</span><span class="n">sustained_scheduler_backlog_timeout</span>
                <span class="ow">or</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">scheduler_backlog_timeout</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.executor.instances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">executor_volume_mounts</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_executor_volumes_config</span><span class="p">(</span><span class="n">volumes</span><span class="o">=</span><span class="n">volumes</span><span class="p">,</span> <span class="n">volume_mounts</span><span class="o">=</span><span class="n">executor_volume_mounts</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">executor_node_selector</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_node_selector</span><span class="p">(</span><span class="n">node_selector</span><span class="o">=</span><span class="n">executor_node_selector</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">executor_labels</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_labels</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">executor_labels</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">executor_annotations</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_annotations</span><span class="p">(</span><span class="n">annotations</span><span class="o">=</span><span class="n">executor_annotations</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">executor_pod_template_path</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_pod_template_path</span><span class="p">(</span><span class="n">executor_pod_template_path</span><span class="p">))</span>
        <span class="n">driver_command_args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;driver&quot;</span><span class="p">,</span> <span class="s2">&quot;--master&quot;</span><span class="p">,</span> <span class="s2">&quot;k8s://https://kubernetes.default.svc.cluster.local:443&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">class_name</span><span class="p">:</span>
            <span class="n">driver_command_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--class&quot;</span><span class="p">,</span> <span class="n">class_name</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">packages</span><span class="p">:</span>
            <span class="n">driver_command_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--packages&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">packages</span><span class="p">)])</span>
        <span class="n">driver_command_args</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_spark_config_to_arguments</span><span class="p">({</span><span class="o">**</span><span class="n">basic_conf</span><span class="p">,</span> <span class="o">**</span><span class="n">spark_conf</span><span class="p">})</span> <span class="o">+</span> <span class="p">[</span><span class="n">app_path</span><span class="p">,</span> <span class="o">*</span><span class="n">main_class_parameters</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">:</span>
            <span class="n">application_configmaps_volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">create_configmap_objects</span><span class="p">(</span>
                <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
                <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
                <span class="n">configmaps</span><span class="o">=</span><span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">configmap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">application_configmaps_volumes</span><span class="p">):</span>
                <span class="n">volumes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">config_map</span><span class="o">=</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1ConfigMapVolumeSource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">driver_volume_mounts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">mount_path</span><span class="o">=</span><span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="s2">&quot;mount_path&quot;</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">application_configmaps_volumes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">pod</span> <span class="o">=</span> <span class="n">SparkAppManager</span><span class="o">.</span><span class="n">create_spark_pod_spec</span><span class="p">(</span>
            <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
            <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
            <span class="n">image_pull_policy</span><span class="o">=</span><span class="n">image_pull_policy</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">service_account</span><span class="o">=</span><span class="n">service_account</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="n">driver_command_args</span><span class="p">,</span>
            <span class="n">extra_labels</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">extra_labels</span><span class="p">,</span> <span class="o">**</span><span class="n">driver_labels</span><span class="p">},</span>
            <span class="n">annotations</span><span class="o">=</span><span class="n">driver_annotations</span><span class="p">,</span>
            <span class="n">pod_resources</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory_overhead</span><span class="si">}</span><span class="s2">Mi&quot;</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="s2">&quot;limits&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory_overhead</span><span class="si">}</span><span class="s2">Mi&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="n">env_from_secrets</span><span class="o">=</span><span class="n">env_from_secrets</span><span class="p">,</span>
            <span class="n">volumes</span><span class="o">=</span><span class="n">volumes</span><span class="p">,</span>
            <span class="n">volume_mounts</span><span class="o">=</span><span class="n">driver_volume_mounts</span><span class="p">,</span>
            <span class="n">node_selector</span><span class="o">=</span><span class="n">driver_node_selector</span><span class="p">,</span>
            <span class="n">tolerations</span><span class="o">=</span><span class="n">driver_tolerations</span><span class="p">,</span>
            <span class="n">init_containers</span><span class="o">=</span><span class="n">driver_init_containers</span><span class="p">,</span>
            <span class="n">host_aliases</span><span class="o">=</span><span class="n">driver_host_aliases</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">k8s_client_manager</span><span class="o">.</span><span class="n">client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
            <span class="n">api</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">secret_values</span><span class="p">:</span>
                <span class="n">application_secret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">create_secret_object</span><span class="p">(</span>
                    <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
                    <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
                    <span class="n">secrets_values</span><span class="o">=</span><span class="n">secret_values</span><span class="p">,</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_secret</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">application_secret</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">configmap</span> <span class="ow">in</span> <span class="n">application_configmaps_volumes</span><span class="p">:</span>
                <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_config_map</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">configmap</span><span class="p">)</span>
            <span class="n">pod</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_pod</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">pod</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">secret_values</span><span class="p">:</span>
                <span class="n">application_secret</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">owner_references</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">k8s</span><span class="o">.</span><span class="n">V1OwnerReference</span><span class="p">(</span>
                        <span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Pod&quot;</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">uid</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">]</span>
                <span class="n">api</span><span class="o">.</span><span class="n">patch_namespaced_secret</span><span class="p">(</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">application_secret</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">body</span><span class="o">=</span><span class="n">application_secret</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">configmap</span> <span class="ow">in</span> <span class="n">application_configmaps_volumes</span><span class="p">:</span>
                <span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">owner_references</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">k8s</span><span class="o">.</span><span class="n">V1OwnerReference</span><span class="p">(</span>
                        <span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Pod&quot;</span><span class="p">,</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">uid</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">]</span>
                <span class="n">api</span><span class="o">.</span><span class="n">patch_namespaced_config_map</span><span class="p">(</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">body</span><span class="o">=</span><span class="n">configmap</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_service</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">SparkAppManager</span><span class="o">.</span><span class="n">create_headless_service_object</span><span class="p">(</span>
                    <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
                    <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                    <span class="n">pod_owner_uid</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
                    <span class="n">extra_labels</span><span class="o">=</span><span class="n">extra_labels</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">app_waiter</span> <span class="o">==</span> <span class="n">SparkAppWait</span><span class="o">.</span><span class="n">LOG</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">stream_logs</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">pod_name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">startup_timeout</span><span class="o">=</span><span class="n">startup_timeout</span><span class="p">,</span>
                <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">app_waiter</span> <span class="o">==</span> <span class="n">SparkAppWait</span><span class="o">.</span><span class="n">WAIT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">wait_for_app</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">pod_name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">poll_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">startup_timeout</span><span class="o">=</span><span class="n">startup_timeout</span><span class="p">,</span>
                <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_app_name_and_id</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">app_id_suffix</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_app_id_suffix</span><span class="p">,</span>
        <span class="n">should_print</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the application name and ID</span>

<span class="sd">        This function will generate a valid application name and ID from the provided application name.</span>
<span class="sd">            It will ensure that the application name and ID respect the Kubernetes naming conventions</span>
<span class="sd">            (e.g. no uppercase characters, no</span>
<span class="sd">        special characters, start with a letter, etc.), and they are not too long</span>
<span class="sd">            (less than 64 characters for service</span>
<span class="sd">        names and labels values).</span>

<span class="sd">        Args:</span>
<span class="sd">            app_name: Name of the Spark application</span>
<span class="sd">            app_id_suffix: Function to generate a suffix for the application ID,</span>
<span class="sd">                defaults to `default_app_id_suffix`</span>
<span class="sd">            should_print: Whether to print logs instead of logging them, defaults to False</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of the application name and ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_name</span><span class="p">:</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;spark-app</span><span class="si">{</span><span class="n">app_id_suffix</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">app_id</span> <span class="o">=</span> <span class="n">app_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">original_app_name</span> <span class="o">=</span> <span class="n">app_name</span>
            <span class="c1"># All to lowercase</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="n">app_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">app_id_suffix_str</span> <span class="o">=</span> <span class="n">app_id_suffix</span><span class="p">()</span>
            <span class="c1"># Maximum length for pod labels and service names is 63 characters</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">63</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">app_id_suffix_str</span><span class="p">)):</span>
                <span class="n">app_name</span> <span class="o">=</span> <span class="n">app_name</span><span class="p">[:</span> <span class="p">(</span><span class="mi">63</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">app_id_suffix_str</span><span class="p">))]</span>
            <span class="c1"># Replace all non-alphanumeric characters with dashes</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^0-9a-zA-Z]+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
            <span class="c1"># Remove leading non-alphabetic characters</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[^a-zA-Z]*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
            <span class="c1"># Remove leading and trailing dashes</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^-*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
            <span class="n">app_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;-*$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
            <span class="n">app_id</span> <span class="o">=</span> <span class="n">app_name</span> <span class="o">+</span> <span class="n">app_id_suffix_str</span>
            <span class="k">if</span> <span class="n">app_name</span> <span class="o">!=</span> <span class="n">original_app_name</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="n">msg</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Application name </span><span class="si">{</span><span class="n">original_app_name</span><span class="si">}</span><span class="s2"> is too long&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot; and will be truncated to </span><span class="si">{</span><span class="n">app_name</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                    <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">app_id</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_value_to_str</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_spark_config_to_arguments</span><span class="p">(</span><span class="n">spark_conf</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert Spark configuration to a list of arguments</span>

<span class="sd">        Args:</span>
<span class="sd">            spark_conf: Spark configuration dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of arguments</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spark_conf</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">spark_conf</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--conf&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">SparkOnK8S</span><span class="o">.</span><span class="n">_value_to_str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_executor_secrets_config</span><span class="p">(</span>
        <span class="n">secret_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spark configuration to load environment variables from the secret</span>

<span class="sd">        Args:</span>
<span class="sd">            secret_values: Secret values to pass to the application as environment variables</span>
<span class="sd">            app_id: Application ID</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spark configuration dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">secret_values</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;spark.kubernetes.executor.secretKeyRef.</span><span class="si">{</span><span class="n">secret_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">secret_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">secret_name</span> <span class="ow">in</span> <span class="n">secret_values</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_executor_volumes_config</span><span class="p">(</span>
        <span class="n">volumes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">volume_mounts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spark configuration to mount volumes to the executors</span>

<span class="sd">        Args:</span>
<span class="sd">            volumes: List of volumes to mount to the driver and/or executors</span>
<span class="sd">            volume_mounts: List of volume mounts to mount to the executors</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spark configuration dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">volumes</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># https://spark.apache.org/docs/latest/running-on-kubernetes.html#using-kubernetes-volumes</span>
        <span class="n">supported_volume_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;hostPath&quot;</span><span class="p">,</span>
            <span class="s2">&quot;emptyDir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nfs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;persistentVolumeClaim&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">loaded_volumes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">volumes_config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">volume</span> <span class="ow">in</span> <span class="n">volumes</span><span class="p">:</span>
            <span class="n">volume_name</span> <span class="o">=</span> <span class="n">volume</span><span class="o">.</span><span class="n">name</span>
            <span class="n">volume_mapped_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">volume_type_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="o">.</span><span class="n">attribute_map</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="o">!=</span> <span class="s2">&quot;name&quot;</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">volume_mapped_type</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="o">.</span><span class="n">attribute_map</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
                    <span class="n">volume_type_str</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="o">.</span><span class="n">openapi_types</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
                    <span class="n">volume</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="n">volume_type</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">k8s</span><span class="p">,</span> <span class="n">volume_type_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">volume_mapped_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_volume_types</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">loaded_volumes</span><span class="p">[</span><span class="n">volume_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_mapped_type</span>
            <span class="n">volumes_config</span><span class="p">[</span><span class="n">volume_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">volume_type</span><span class="o">.</span><span class="n">attribute_map</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">option_name</span> <span class="o">=</span> <span class="n">volume_type</span><span class="o">.</span><span class="n">attribute_map</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
                    <span class="n">volumes_config</span><span class="p">[</span><span class="n">volume_name</span><span class="p">][</span>
                        <span class="sa">f</span><span class="s2">&quot;spark.kubernetes.executor.volumes.</span><span class="si">{</span><span class="n">volume_mapped_type</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">volume_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">option_name</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">volume_mount</span> <span class="ow">in</span> <span class="n">volume_mounts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">volume_mount</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">loaded_volumes</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Volume </span><span class="si">{</span><span class="n">volume_mount</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not found in the volumes list or is not supported.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;Please make sure to add the volume to the volumes list and use one of&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; the supported types: </span><span class="si">{</span><span class="n">supported_volume_types</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">volumes_config</span><span class="p">[</span><span class="n">volume_mount</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
            <span class="n">volume_config_prefix</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;spark.kubernetes.executor.volumes.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loaded_volumes</span><span class="p">[</span><span class="n">volume_mount</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">volume_mount</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.mount&quot;</span>
            <span class="p">)</span>
            <span class="n">config</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume_config_prefix</span><span class="si">}</span><span class="s2">.path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_mount</span><span class="o">.</span><span class="n">mount_path</span>
            <span class="k">if</span> <span class="n">volume_mount</span><span class="o">.</span><span class="n">sub_path</span><span class="p">:</span>
                <span class="n">config</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume_config_prefix</span><span class="si">}</span><span class="s2">.subPath&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volume_mount</span><span class="o">.</span><span class="n">sub_path</span>
            <span class="k">if</span> <span class="n">volume_mount</span><span class="o">.</span><span class="n">read_only</span><span class="p">:</span>
                <span class="n">config</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume_config_prefix</span><span class="si">}</span><span class="s2">.readOnly&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">config</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_executor_node_selector</span><span class="p">(</span>
        <span class="n">node_selector</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spark configuration to set node selector for the executors</span>

<span class="sd">        Args:</span>
<span class="sd">            node_selector: Node selector for the executors</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spark configuration dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node_selector</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;spark.kubernetes.executor.node.selector.</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">node_selector</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_executor_labels</span><span class="p">(</span>
        <span class="n">labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spark configuration to set labels for the executors</span>

<span class="sd">        Args:</span>
<span class="sd">            labels: Labels for the executors</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spark configuration dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;spark.kubernetes.executor.label.</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_executor_annotations</span><span class="p">(</span>
        <span class="n">annotations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spark configuration to set annotations for the executors</span>

<span class="sd">        Args:</span>
<span class="sd">            annotations: Annotations for the executors</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spark configuration dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">annotations</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;spark.kubernetes.executor.annotation.</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">annotations</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_executor_pod_template_path</span><span class="p">(</span>
        <span class="n">executor_pod_template_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spark configuration to set the executor pod template file</span>

<span class="sd">        Args:</span>
<span class="sd">            executor_pod_template_path: Path to the executor pod template file</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spark configuration dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">executor_pod_template_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;spark.kubernetes.executor.podTemplateFile&quot;</span><span class="p">:</span> <span class="n">executor_pod_template_path</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="spark_on_k8s.client.SparkOnK8S.submit_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">submit_app</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">app_path</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">service_account</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">spark_conf</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">class_name</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">packages</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">app_arguments</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">app_id_suffix</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">app_waiter</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">image_pull_policy</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">ui_reverse_proxy</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_resources</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_resources</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_instances</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">should_print</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">secret_values</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_ephemeral_configmaps_volumes</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_env_vars_from_secrets</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">volumes</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_volume_mounts</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_volume_mounts</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_node_selector</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_node_selector</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_annotations</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_annotations</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_labels</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_labels</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_tolerations</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">executor_pod_template_path</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">startup_timeout</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_init_containers</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">driver_host_aliases</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Submit a Spark app to Kubernetes</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Docker image to use for the Spark driver and executors</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the application JAR / Python / R file</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace to use, defaults to "default"</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>service_account</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes service account to use for the Spark driver,
defaults to "spark"</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the Spark application, defaults to a generated name as
<code>spark-app{app_id_suffix()}</code></p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spark_conf</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of spark configuration to pass to the application</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>class_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the class to execute</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>packages</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of maven coordinates of jars to include in the classpath</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_arguments</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of arguments to pass to the application</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_id_suffix</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[], <span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to generate a suffix for the application ID, defaults to
<code>default_app_id_suffix</code></p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_waiter</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;no_wait&#39;, &#39;wait&#39;, &#39;log&#39;] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to wait for the app to finish. One of "no_wait", "wait", or "log"</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_pull_policy</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;Always&#39;, &#39;Never&#39;, &#39;IfNotPresent&#39;] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image pull policy for the driver and executors, defaults to "IfNotPresent"</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ui_reverse_proxy</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use a reverse proxy for the Spark UI, defaults to False</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_resources</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;PodResources&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;spark_on_k8s.client.PodResources&lt;/code&gt;)" href="#spark_on_k8s.client.PodResources">PodResources</a> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resources to request for the Spark driver. Defaults to 1 CPU core, 1Gi of
memory and512Mi of memory overhead</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>executor_resources</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;PodResources&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;spark_on_k8s.client.PodResources&lt;/code&gt;)" href="#spark_on_k8s.client.PodResources">PodResources</a> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resources to request for the Spark executors. Defaults to 1 CPU core, 1Gi
of memory and 512Mi of memory overhead</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>executor_instances</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;ExecutorInstances&lt;/code&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;spark_on_k8s.client.ExecutorInstances&lt;/code&gt;)" href="#spark_on_k8s.client.ExecutorInstances">ExecutorInstances</a> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of executors to request. If max and min are not provided, dynamic
allocation will be disabled and the number of executors will be fixed to initial or 2 if
initial is not provided. If max or min or both are provided, dynamic allocation will be
enabled and the number of executors will be between min and max (inclusive), and initial
will be the initial number of executors with a default of 0.</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>should_print</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print logs instead of logging them, defaults to False</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>secret_values</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of secret values to pass to the application as environment variables</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_ephemeral_configmaps_volumes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="spark_on_k8s.utils.types.ConfigMap">ConfigMap</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of ephemeral configmaps to create for the application
driver</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_env_vars_from_secrets</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of secret names to load environment variables from for
the driver</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>volumes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="kubernetes.client.V1Volume">V1Volume</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of volumes to mount to the driver and/or executors</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_volume_mounts</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="kubernetes.client.V1VolumeMount">V1VolumeMount</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of volume mounts to mount to the driver</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>executor_volume_mounts</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="kubernetes.client.V1VolumeMount">V1VolumeMount</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of volume mounts to mount to the executors</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_node_selector</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node selector for the driver</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>executor_node_selector</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node selector for the executors</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_tolerations</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="kubernetes.client.V1Toleration">V1Toleration</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tolerations for the driver</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>executor_pod_template_path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the executor pod template file</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>startup_timeout</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timeout in seconds to wait for the application to start</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_init_containers</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="kubernetes.client.V1Container">V1Container</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of init containers to run before the driver starts</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>driver_host_aliases</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="kubernetes.client.V1HostAlias">V1HostAlias</span>] | <a class="autorefs autorefs-internal" title="&lt;code&gt;ArgNotSet&lt;/code&gt; (&lt;code&gt;spark_on_k8s.utils.types.ArgNotSet&lt;/code&gt;)" href="../utils/types/#spark_on_k8s.utils.types.ArgNotSet">ArgNotSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of host aliases for the driver</p>
              </div>
            </td>
            <td>
                  <code><span title="spark_on_k8s.utils.types.NOTSET">NOTSET</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the Spark application pod</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spark_on_k8s/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">submit_app</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">app_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">service_account</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">spark_conf</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">class_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">packages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">app_arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">app_id_suffix</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">app_waiter</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;no_wait&quot;</span><span class="p">,</span> <span class="s2">&quot;wait&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">image_pull_policy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Always&quot;</span><span class="p">,</span> <span class="s2">&quot;Never&quot;</span><span class="p">,</span> <span class="s2">&quot;IfNotPresent&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">ui_reverse_proxy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_resources</span><span class="p">:</span> <span class="n">PodResources</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_resources</span><span class="p">:</span> <span class="n">PodResources</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_instances</span><span class="p">:</span> <span class="n">ExecutorInstances</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">should_print</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">secret_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConfigMap</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_env_vars_from_secrets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">volumes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_volume_mounts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_volume_mounts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_node_selector</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_node_selector</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_annotations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_annotations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_tolerations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Toleration</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">executor_pod_template_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">startup_timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_init_containers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1Container</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
    <span class="n">driver_host_aliases</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1HostAlias</span><span class="p">]</span> <span class="o">|</span> <span class="n">ArgNotSet</span> <span class="o">=</span> <span class="n">NOTSET</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Submit a Spark app to Kubernetes</span>

<span class="sd">    Args:</span>
<span class="sd">        image: Docker image to use for the Spark driver and executors</span>
<span class="sd">        app_path: Path to the application JAR / Python / R file</span>
<span class="sd">        namespace: Kubernetes namespace to use, defaults to &quot;default&quot;</span>
<span class="sd">        service_account: Kubernetes service account to use for the Spark driver,</span>
<span class="sd">            defaults to &quot;spark&quot;</span>
<span class="sd">        app_name: Name of the Spark application, defaults to a generated name as</span>
<span class="sd">            `spark-app{app_id_suffix()}`</span>
<span class="sd">        spark_conf: Dictionary of spark configuration to pass to the application</span>
<span class="sd">        class_name: Name of the class to execute</span>
<span class="sd">        packages: List of maven coordinates of jars to include in the classpath</span>
<span class="sd">        app_arguments: List of arguments to pass to the application</span>
<span class="sd">        app_id_suffix: Function to generate a suffix for the application ID, defaults to</span>
<span class="sd">            `default_app_id_suffix`</span>
<span class="sd">        app_waiter: How to wait for the app to finish. One of &quot;no_wait&quot;, &quot;wait&quot;, or &quot;log&quot;</span>
<span class="sd">        image_pull_policy: Image pull policy for the driver and executors, defaults to &quot;IfNotPresent&quot;</span>
<span class="sd">        ui_reverse_proxy: Whether to use a reverse proxy for the Spark UI, defaults to False</span>
<span class="sd">        driver_resources: Resources to request for the Spark driver. Defaults to 1 CPU core, 1Gi of</span>
<span class="sd">            memory and512Mi of memory overhead</span>
<span class="sd">        executor_resources: Resources to request for the Spark executors. Defaults to 1 CPU core, 1Gi</span>
<span class="sd">            of memory and 512Mi of memory overhead</span>
<span class="sd">        executor_instances: Number of executors to request. If max and min are not provided, dynamic</span>
<span class="sd">            allocation will be disabled and the number of executors will be fixed to initial or 2 if</span>
<span class="sd">            initial is not provided. If max or min or both are provided, dynamic allocation will be</span>
<span class="sd">            enabled and the number of executors will be between min and max (inclusive), and initial</span>
<span class="sd">            will be the initial number of executors with a default of 0.</span>
<span class="sd">        should_print: Whether to print logs instead of logging them, defaults to False</span>
<span class="sd">        secret_values: Dictionary of secret values to pass to the application as environment variables</span>
<span class="sd">        driver_ephemeral_configmaps_volumes: List of ephemeral configmaps to create for the application</span>
<span class="sd">            driver</span>
<span class="sd">        driver_env_vars_from_secrets: List of secret names to load environment variables from for</span>
<span class="sd">            the driver</span>
<span class="sd">        volumes: List of volumes to mount to the driver and/or executors</span>
<span class="sd">        driver_volume_mounts: List of volume mounts to mount to the driver</span>
<span class="sd">        executor_volume_mounts: List of volume mounts to mount to the executors</span>
<span class="sd">        driver_node_selector: Node selector for the driver</span>
<span class="sd">        executor_node_selector: Node selector for the executors</span>
<span class="sd">        driver_tolerations: List of tolerations for the driver</span>
<span class="sd">        executor_pod_template_path: Path to the executor pod template file</span>
<span class="sd">        startup_timeout: Timeout in seconds to wait for the application to start</span>
<span class="sd">        driver_init_containers: List of init containers to run before the driver starts</span>
<span class="sd">        driver_host_aliases: List of host aliases for the driver</span>

<span class="sd">    Returns:</span>
<span class="sd">        Name of the Spark application pod</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">image</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DOCKER_IMAGE</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Docker image is not set.&quot;</span>
                <span class="s2">&quot;Please set the image argument or the environment variable SPARK_ON_K8S_DOCKER_IMAGE&quot;</span>
            <span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DOCKER_IMAGE</span>
    <span class="k">if</span> <span class="n">app_path</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_PATH</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Application path is not set.&quot;</span>
                <span class="s2">&quot;Please set the app_path argument or the environment variable SPARK_ON_K8S_APP_PATH&quot;</span>
            <span class="p">)</span>
        <span class="n">app_path</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_PATH</span>
    <span class="k">if</span> <span class="n">namespace</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_NAMESPACE</span>
    <span class="k">if</span> <span class="n">service_account</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">service_account</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SERVICE_ACCOUNT</span>
    <span class="k">if</span> <span class="n">app_name</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">app_name</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_NAME</span>
    <span class="k">if</span> <span class="n">spark_conf</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">spark_conf</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SPARK_CONF</span>
    <span class="k">if</span> <span class="n">class_name</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">class_name</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_CLASS_NAME</span>
    <span class="k">if</span> <span class="n">packages</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">packages</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_PACKAGES</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_PACKAGES</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">app_arguments</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">app_arguments</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_ARGUMENTS</span>
    <span class="k">if</span> <span class="n">app_id_suffix</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">app_id_suffix</span> <span class="o">=</span> <span class="n">default_app_id_suffix</span>
    <span class="k">if</span> <span class="n">app_waiter</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">app_waiter</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_APP_WAITER</span>
    <span class="k">if</span> <span class="n">image_pull_policy</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">image_pull_policy</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_IMAGE_PULL_POLICY</span>
    <span class="k">if</span> <span class="n">ui_reverse_proxy</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">ui_reverse_proxy</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_UI_REVERSE_PROXY</span>
    <span class="k">if</span> <span class="n">driver_resources</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">driver_resources</span> <span class="o">=</span> <span class="n">PodResources</span><span class="p">(</span>
            <span class="n">cpu</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_CPU</span><span class="p">,</span>
            <span class="n">memory</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_MEMORY</span><span class="p">,</span>
            <span class="n">memory_overhead</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_MEMORY_OVERHEAD</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">executor_resources</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">executor_resources</span> <span class="o">=</span> <span class="n">PodResources</span><span class="p">(</span>
            <span class="n">cpu</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_CPU</span><span class="p">,</span>
            <span class="n">memory</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MEMORY</span><span class="p">,</span>
            <span class="n">memory_overhead</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MEMORY_OVERHEAD</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">executor_instances</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">executor_instances</span> <span class="o">=</span> <span class="n">ExecutorInstances</span><span class="p">(</span>
            <span class="nb">min</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MIN_INSTANCES</span><span class="p">,</span>
            <span class="nb">max</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_MAX_INSTANCES</span><span class="p">,</span>
            <span class="n">initial</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_INITIAL_INSTANCES</span><span class="p">,</span>
            <span class="n">executor_allocation_ratio</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_ALLOCATION_RATIO</span><span class="p">,</span>
            <span class="n">scheduler_backlog_timeout</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SCHEDULER_BACKLOG_TIMEOUT</span><span class="p">,</span>
            <span class="n">sustained_scheduler_backlog_timeout</span><span class="o">=</span><span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SUSTAINED_SCHEDULER_BACKLOG_TIMEOUT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">executor_instances</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">app_name</span><span class="p">,</span> <span class="n">app_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_app_name_and_id</span><span class="p">(</span>
        <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span> <span class="n">app_id_suffix</span><span class="o">=</span><span class="n">app_id_suffix</span><span class="p">,</span> <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">secret_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTSET</span> <span class="ow">and</span> <span class="n">secret_values</span><span class="p">:</span>
        <span class="n">env_from_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">app_id</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">secret_values</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_SECRET_ENV_VAR</span>
        <span class="n">env_from_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">app_id</span><span class="p">]</span> <span class="k">if</span> <span class="n">secret_values</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">driver_ephemeral_configmaps_volumes</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">driver_ephemeral_configmaps_volumes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">driver_env_vars_from_secrets</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">driver_env_vars_from_secrets</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_DRIVER_ENV_VARS_FROM_SECRET</span>
    <span class="k">if</span> <span class="n">driver_env_vars_from_secrets</span><span class="p">:</span>
        <span class="n">env_from_secrets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">driver_env_vars_from_secrets</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">volumes</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">volumes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">volumes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">driver_volume_mounts</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_volume_mounts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">driver_volume_mounts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">executor_volume_mounts</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_volume_mounts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">executor_volume_mounts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">driver_node_selector</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_node_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">driver_node_selector</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">executor_node_selector</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_node_selector</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">executor_node_selector</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">driver_annotations</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_annotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">driver_annotations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">executor_annotations</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_annotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">executor_annotations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">driver_labels</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">driver_labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">executor_labels</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">executor_labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">driver_tolerations</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">driver_tolerations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">driver_tolerations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">executor_pod_template_path</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="ow">or</span> <span class="n">executor_pod_template_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">executor_pod_template_path</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_EXECUTOR_POD_TEMPLATE_PATH</span>
    <span class="k">if</span> <span class="n">startup_timeout</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">startup_timeout</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">SPARK_ON_K8S_STARTUP_TIMEOUT</span>
    <span class="k">if</span> <span class="n">driver_init_containers</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">driver_init_containers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">driver_host_aliases</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">driver_host_aliases</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">spark_conf</span> <span class="o">=</span> <span class="n">spark_conf</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">main_class_parameters</span> <span class="o">=</span> <span class="n">app_arguments</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="n">driver_resources</span> <span class="o">=</span> <span class="n">driver_resources</span> <span class="ow">or</span> <span class="n">PodResources</span><span class="p">()</span>
    <span class="n">executor_resources</span> <span class="o">=</span> <span class="n">executor_resources</span> <span class="ow">or</span> <span class="n">PodResources</span><span class="p">()</span>
    <span class="n">executor_instances</span> <span class="o">=</span> <span class="n">executor_instances</span> <span class="ow">or</span> <span class="n">ExecutorInstances</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">basic_conf</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;spark.app.name&quot;</span><span class="p">:</span> <span class="n">app_name</span><span class="p">,</span>
        <span class="s2">&quot;spark.app.id&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
        <span class="s2">&quot;spark.kubernetes.namespace&quot;</span><span class="p">:</span> <span class="n">namespace</span><span class="p">,</span>
        <span class="s2">&quot;spark.kubernetes.authenticate.driver.serviceAccountName&quot;</span><span class="p">:</span> <span class="n">service_account</span><span class="p">,</span>
        <span class="s2">&quot;spark.kubernetes.container.image&quot;</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span>
        <span class="s2">&quot;spark.driver.host&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
        <span class="s2">&quot;spark.driver.port&quot;</span><span class="p">:</span> <span class="s2">&quot;7077&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spark.kubernetes.driver.pod.name&quot;</span><span class="p">:</span> <span class="n">SparkAppManager</span><span class="o">.</span><span class="n">_get_pod_name</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">),</span>
        <span class="s2">&quot;spark.kubernetes.executor.podNamePrefix&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
        <span class="s2">&quot;spark.kubernetes.container.image.pullPolicy&quot;</span><span class="p">:</span> <span class="n">image_pull_policy</span><span class="p">,</span>
        <span class="s2">&quot;spark.driver.memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spark.executor.cores&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_resources</span><span class="o">.</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spark.executor.memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_resources</span><span class="o">.</span><span class="n">memory</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spark.executor.memoryOverhead&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_resources</span><span class="o">.</span><span class="n">memory_overhead</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_secrets_config</span><span class="p">(</span><span class="n">secret_values</span><span class="o">=</span><span class="n">secret_values</span><span class="p">,</span> <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">extra_labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">ui_reverse_proxy</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.ui.proxyBase&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/webserver/ui/</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">app_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.ui.proxyRedirectUri&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>
        <span class="n">extra_labels</span><span class="p">[</span><span class="s2">&quot;spark-ui-proxy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
    <span class="k">if</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.shuffleTracking.enabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.minExecutors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">min</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.maxExecutors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.initialExecutors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.executorAllocationRatio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
            <span class="n">executor_instances</span><span class="o">.</span><span class="n">executor_allocation_ratio</span>
        <span class="p">)</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.schedulerBacklogTimeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">executor_instances</span><span class="o">.</span><span class="n">scheduler_backlog_timeout</span>
        <span class="p">)</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.dynamicAllocation.sustainedSchedulerBacklogTimeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">executor_instances</span><span class="o">.</span><span class="n">sustained_scheduler_backlog_timeout</span>
            <span class="ow">or</span> <span class="n">executor_instances</span><span class="o">.</span><span class="n">scheduler_backlog_timeout</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="p">[</span><span class="s2">&quot;spark.executor.instances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">executor_instances</span><span class="o">.</span><span class="n">initial</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">executor_volume_mounts</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executor_volumes_config</span><span class="p">(</span><span class="n">volumes</span><span class="o">=</span><span class="n">volumes</span><span class="p">,</span> <span class="n">volume_mounts</span><span class="o">=</span><span class="n">executor_volume_mounts</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">executor_node_selector</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_node_selector</span><span class="p">(</span><span class="n">node_selector</span><span class="o">=</span><span class="n">executor_node_selector</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">executor_labels</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_labels</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">executor_labels</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">executor_annotations</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_annotations</span><span class="p">(</span><span class="n">annotations</span><span class="o">=</span><span class="n">executor_annotations</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">executor_pod_template_path</span><span class="p">:</span>
        <span class="n">basic_conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_executor_pod_template_path</span><span class="p">(</span><span class="n">executor_pod_template_path</span><span class="p">))</span>
    <span class="n">driver_command_args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;driver&quot;</span><span class="p">,</span> <span class="s2">&quot;--master&quot;</span><span class="p">,</span> <span class="s2">&quot;k8s://https://kubernetes.default.svc.cluster.local:443&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">class_name</span><span class="p">:</span>
        <span class="n">driver_command_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--class&quot;</span><span class="p">,</span> <span class="n">class_name</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">packages</span><span class="p">:</span>
        <span class="n">driver_command_args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--packages&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">packages</span><span class="p">)])</span>
    <span class="n">driver_command_args</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_spark_config_to_arguments</span><span class="p">({</span><span class="o">**</span><span class="n">basic_conf</span><span class="p">,</span> <span class="o">**</span><span class="n">spark_conf</span><span class="p">})</span> <span class="o">+</span> <span class="p">[</span><span class="n">app_path</span><span class="p">,</span> <span class="o">*</span><span class="n">main_class_parameters</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">:</span>
        <span class="n">application_configmaps_volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">create_configmap_objects</span><span class="p">(</span>
            <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
            <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
            <span class="n">configmaps</span><span class="o">=</span><span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">configmap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">application_configmaps_volumes</span><span class="p">):</span>
            <span class="n">volumes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">k8s</span><span class="o">.</span><span class="n">V1Volume</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">config_map</span><span class="o">=</span><span class="n">k8s</span><span class="o">.</span><span class="n">V1ConfigMapVolumeSource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">driver_volume_mounts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">k8s</span><span class="o">.</span><span class="n">V1VolumeMount</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">mount_path</span><span class="o">=</span><span class="n">driver_ephemeral_configmaps_volumes</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="s2">&quot;mount_path&quot;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">application_configmaps_volumes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">pod</span> <span class="o">=</span> <span class="n">SparkAppManager</span><span class="o">.</span><span class="n">create_spark_pod_spec</span><span class="p">(</span>
        <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
        <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
        <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
        <span class="n">image_pull_policy</span><span class="o">=</span><span class="n">image_pull_policy</span><span class="p">,</span>
        <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
        <span class="n">service_account</span><span class="o">=</span><span class="n">service_account</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="n">driver_command_args</span><span class="p">,</span>
        <span class="n">extra_labels</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">extra_labels</span><span class="p">,</span> <span class="o">**</span><span class="n">driver_labels</span><span class="p">},</span>
        <span class="n">annotations</span><span class="o">=</span><span class="n">driver_annotations</span><span class="p">,</span>
        <span class="n">pod_resources</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory_overhead</span><span class="si">}</span><span class="s2">Mi&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;limits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">cpu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">driver_resources</span><span class="o">.</span><span class="n">memory_overhead</span><span class="si">}</span><span class="s2">Mi&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="n">env_from_secrets</span><span class="o">=</span><span class="n">env_from_secrets</span><span class="p">,</span>
        <span class="n">volumes</span><span class="o">=</span><span class="n">volumes</span><span class="p">,</span>
        <span class="n">volume_mounts</span><span class="o">=</span><span class="n">driver_volume_mounts</span><span class="p">,</span>
        <span class="n">node_selector</span><span class="o">=</span><span class="n">driver_node_selector</span><span class="p">,</span>
        <span class="n">tolerations</span><span class="o">=</span><span class="n">driver_tolerations</span><span class="p">,</span>
        <span class="n">init_containers</span><span class="o">=</span><span class="n">driver_init_containers</span><span class="p">,</span>
        <span class="n">host_aliases</span><span class="o">=</span><span class="n">driver_host_aliases</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">k8s_client_manager</span><span class="o">.</span><span class="n">client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
        <span class="n">api</span> <span class="o">=</span> <span class="n">k8s</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">secret_values</span><span class="p">:</span>
            <span class="n">application_secret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">create_secret_object</span><span class="p">(</span>
                <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
                <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
                <span class="n">secrets_values</span><span class="o">=</span><span class="n">secret_values</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_secret</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">application_secret</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">configmap</span> <span class="ow">in</span> <span class="n">application_configmaps_volumes</span><span class="p">:</span>
            <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_config_map</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">configmap</span><span class="p">)</span>
        <span class="n">pod</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_pod</span><span class="p">(</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">pod</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">secret_values</span><span class="p">:</span>
            <span class="n">application_secret</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">owner_references</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k8s</span><span class="o">.</span><span class="n">V1OwnerReference</span><span class="p">(</span>
                    <span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Pod&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">uid</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">]</span>
            <span class="n">api</span><span class="o">.</span><span class="n">patch_namespaced_secret</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">application_secret</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">application_secret</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">configmap</span> <span class="ow">in</span> <span class="n">application_configmaps_volumes</span><span class="p">:</span>
            <span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">owner_references</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k8s</span><span class="o">.</span><span class="n">V1OwnerReference</span><span class="p">(</span>
                    <span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Pod&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">uid</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">]</span>
            <span class="n">api</span><span class="o">.</span><span class="n">patch_namespaced_config_map</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">configmap</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">configmap</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">api</span><span class="o">.</span><span class="n">create_namespaced_service</span><span class="p">(</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">SparkAppManager</span><span class="o">.</span><span class="n">create_headless_service_object</span><span class="p">(</span>
                <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">,</span>
                <span class="n">app_id</span><span class="o">=</span><span class="n">app_id</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">pod_owner_uid</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
                <span class="n">extra_labels</span><span class="o">=</span><span class="n">extra_labels</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">app_waiter</span> <span class="o">==</span> <span class="n">SparkAppWait</span><span class="o">.</span><span class="n">LOG</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">stream_logs</span><span class="p">(</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">pod_name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">startup_timeout</span><span class="o">=</span><span class="n">startup_timeout</span><span class="p">,</span>
            <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">app_waiter</span> <span class="o">==</span> <span class="n">SparkAppWait</span><span class="o">.</span><span class="n">WAIT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span><span class="o">.</span><span class="n">wait_for_app</span><span class="p">(</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">pod_name</span><span class="o">=</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">poll_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">startup_timeout</span><span class="o">=</span><span class="n">startup_timeout</span><span class="p">,</span>
            <span class="n">should_print</span><span class="o">=</span><span class="n">should_print</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="spark_on_k8s.client.default_app_id_suffix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">default_app_id_suffix</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Default function to generate a suffix for the application ID</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the current timestamp in the format %Y%m%d%H%M%S prefixed with a dash (e.g. -20240101123456)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>spark_on_k8s/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">default_app_id_suffix</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Default function to generate a suffix for the application ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        the current timestamp in the format %Y%m%d%H%M%S prefixed with a dash (e.g. -20240101123456)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="April 7, 2025 20:37:53">April 7, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.tooltips", "content.code.annotate", "navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": ["latest", "develop"], "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>